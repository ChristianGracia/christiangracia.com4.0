<div *ngIf="loadingSong" class="flex flex-col justify-center song-loader">
  <div
    class="current-text flex flex-row align-center mat-subheading-1 loading loading-animation"
  >
    <span *ngFor="let char of loadingText">
      {{ char }}
    </span>
  </div>
  <mat-spinner class="spinner" diameter="22" color="accent"></mat-spinner>
</div>

<div
  *ngIf="song && !loadingSong"
  class="flex flex-col justify-center song-container"
>
  <div class="song-row">
    <div class="song-left-col">
      <img
        height="36px"
        width="36px"
        [src]="song.images[1]"
        alt="{{ song.artist }} album image"
      />
      <div class="song-info-container">
        <span class="accent-color mat-caption song-name"
          >{{
            song.name.length > 25
              ? song.name.substring(0, 20) + "..."
              : song.name
          }}
        </span>
        <span class="mat-caption song-name">{{ song.artist }}</span>
      </div>
    </div>
    <div class="song-right-col">
      <mat-icon
        class="rewind-button clickable"
        (click)="skipSong('back')"
        color="accent"
        *ngIf="songIndex > 0"
        >fast_rewind</mat-icon
      >
      <mat-icon
        class="play-button clickable"
        (click)="playPreviewOfSong()"
        color="accent"
        *ngIf="song.previewUrl"
        >{{ !songPlaying ? "play_circle_outline" : "pause" }}</mat-icon
      >
      <mat-icon
        class="forward-button clickable"
        (click)="skipSong('forward')"
        color="accent"
        *ngIf="songIndex < recentSongs.length - 1"
        >fast_forward</mat-icon
      >
    </div>
  </div>
  <div class="song-progress-bar-container">
    <mat-progress-bar
      aria-valuemin="00:00"
      aria-valuemax="30:00"
      color="accent"
      class="song-progress-bar"
      mode="determinate"
      value="{{ (songProgress / songDuration) * 100 }}"
    ></mat-progress-bar>
    <div class="song-progress-bar-text-container">
      <p class="song-progress-bar-text">{{ currentTime }}</p>
      <p></p>
      <p class="song-progress-bar-text">{{ endTime }}</p>
    </div>
  </div>
  <div class="current-text flex flex-row align-center mat-display-1">
    <div class="shockwave-container">
      <mat-icon
        class="spotify-image"
        color="accent"
        class="spotify-image shock shock--shockwave is-active"
      >
        headphones
      </mat-icon>
    </div>
    <div class="mat-caption" *ngIf="song.playedAt">
      Last played at {{ formatDate(song.playedAt) }}
    </div>
    <ng-template
      class="loading loading-animation"
      ngFor
      let-arr
      [ngForOf]="currentText"
      *ngIf="!song.playedAt"
    >
      <div class="loading loading-animation" style="padding: 2px">
        <span *ngFor="let char of arr">
          {{ char }}
        </span>
      </div>
    </ng-template>
  </div>
</div>
